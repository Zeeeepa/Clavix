## File Format Reference

### .clavix-implement-config.json

Implementation state configuration file.

**Location:** `.clavix/outputs/{project}/.clavix-implement-config.json`

**Schema:**
```json
{
  "commitStrategy": "per-task" | "per-5-tasks" | "per-phase" | "none",
  "tasksPath": "string - absolute path to tasks.md",
  "currentTask": {
    "id": "phase-N-name-M",
    "description": "Task description text",
    "phase": "Phase Name",
    "completed": false
  },
  "stats": {
    "total": 16,
    "completed": 4,
    "remaining": 12,
    "percentage": 25
  },
  "timestamp": "2024-01-15T10:30:00.000Z",
  "completedTaskIds": ["phase-1-setup-1", "phase-1-setup-2"],
  "blockedTasks": [
    {
      "taskId": "phase-2-auth-3",
      "reason": "Waiting for API keys",
      "timestamp": "2024-01-15T11:00:00.000Z"
    }
  ]
}
```

**Agent Usage Rules:**
- READ this file to determine current state
- NEVER modify directly - use `clavix task-complete` to update
- IF missing: Run `clavix implement` to initialize
- IF corrupted: Report as UNRECOVERABLE error

### tasks.md Format

Task breakdown file generated by /clavix:plan.

**Location:** `.clavix/outputs/{project}/tasks.md`

**Structure:**
```markdown
# Implementation Tasks: {Project Name}

Generated from: {PRD filename}
Created: {timestamp}

---

## Phase 1: {Phase Name}

- [ ] {Task description}
  - Task ID: `phase-1-{sanitized-name}-1`
  - PRD Reference: {section-name}

- [ ] {Another task}
  - Task ID: `phase-1-{sanitized-name}-2`

- [x] {Completed task}
  - Task ID: `phase-1-{sanitized-name}-3`

## Phase 2: {Phase Name}

- [ ] {Task description}
  - Task ID: `phase-2-{sanitized-name}-1`

---

## Progress Summary

- Total Tasks: {N}
- Completed: {M}
- Remaining: {N-M}
```

**Task ID Pattern:** `phase-{N}-{sanitized-name}-{M}`
- `N` = Phase number (1-indexed)
- `sanitized-name` = Lowercase, hyphens for spaces, no special chars
- `M` = Task counter within phase (1-indexed)

**Valid Examples:**
- `phase-1-setup-configuration-1`
- `phase-2-user-authentication-3`
- `phase-3-api-integration-2`

**Invalid Examples:**
- `phase1-setup-1` - Missing hyphen after "phase"
- `Phase-1-Setup-1` - Must be lowercase
- `phase-1-setup` - Missing task number

### .index.json (Prompts)

Index file for saved prompts.

**Location:** `.clavix/outputs/prompts/{type}/.index.json`

**Schema:**
```json
{
  "version": "1.0",
  "prompts": [
    {
      "id": "fast-20240115-103000-a1b2c3",
      "filename": "fast-20240115-103000-a1b2c3.md",
      "created": "2024-01-15T10:30:00.000Z",
      "intent": "code-generation",
      "quality": {
        "original": 42,
        "optimized": 78
      },
      "executed": false,
      "executedAt": null
    }
  ]
}
```

### PRD Files

**Full PRD:** `.clavix/outputs/{project}/full-prd.md`
- Complete team-facing document
- All sections expanded

**Quick PRD:** `.clavix/outputs/{project}/quick-prd.md`
- 2-3 paragraph AI-optimized version
- Key requirements only

**Mini PRD:** `.clavix/outputs/{project}/mini-prd.md`
- From /clavix:summarize
- Extracted from conversation

### Session Files

**Location:** `.clavix/sessions/{session-id}.json`

**Schema:**
```json
{
  "id": "session-uuid",
  "projectName": "optional-name",
  "status": "active" | "completed",
  "created": "2024-01-15T10:00:00.000Z",
  "updated": "2024-01-15T11:30:00.000Z",
  "messages": [
    {
      "role": "user" | "assistant",
      "content": "message text",
      "timestamp": "2024-01-15T10:05:00.000Z"
    }
  ],
  "tags": ["feature", "auth"],
  "description": "Optional session description"
}
```

### Directory Structure Overview

```
.clavix/
├── outputs/
│   ├── prompts/
│   │   ├── fast/
│   │   │   ├── .index.json
│   │   │   └── fast-{timestamp}-{hash}.md
│   │   └── deep/
│   │       ├── .index.json
│   │       └── deep-{timestamp}-{hash}.md
│   ├── {project-name}/
│   │   ├── full-prd.md
│   │   ├── quick-prd.md
│   │   ├── tasks.md
│   │   └── .clavix-implement-config.json
│   └── archive/
│       └── {archived-project}/
├── sessions/
│   └── {session-id}.json
└── config.json (global config)
```
