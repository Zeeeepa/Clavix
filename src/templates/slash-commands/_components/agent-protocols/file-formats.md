## File Format Reference (v5 Agentic-First)

### .clavix-implement-config.json

Implementation state configuration file.

**Location:** `.clavix/outputs/{project}/.clavix-implement-config.json`

**Schema:**
```json
{
  "commitStrategy": "per-task" | "per-5-tasks" | "per-phase" | "none",
  "tasksPath": "string - absolute path to tasks.md",
  "currentTask": {
    "id": "phase-N-name-M",
    "description": "Task description text",
    "phase": "Phase Name",
    "completed": false
  },
  "stats": {
    "total": 16,
    "completed": 4,
    "remaining": 12,
    "percentage": 25
  },
  "timestamp": "2024-01-15T10:30:00.000Z",
  "completedTaskIds": ["phase-1-setup-1", "phase-1-setup-2"],
  "blockedTasks": [
    {
      "taskId": "phase-2-auth-3",
      "reason": "Waiting for API keys",
      "timestamp": "2024-01-15T11:00:00.000Z"
    }
  ]
}
```

**Agent Usage Rules:**
- READ this file to determine current state
- UPDATE using Edit tool when marking tasks complete
- IF missing: Create with initial state
- IF corrupted: Report as UNRECOVERABLE error

### tasks.md Format

Task breakdown file generated by /clavix:plan.

**Location:** `.clavix/outputs/{project}/tasks.md`

**Structure:**
```markdown
# Implementation Tasks: {Project Name}

Generated from: {PRD filename}
Created: {timestamp}

---

## Phase 1: {Phase Name}

- [ ] {Task description}
  - Task ID: `phase-1-{sanitized-name}-1`
  - PRD Reference: {section-name}

- [ ] {Another task}
  - Task ID: `phase-1-{sanitized-name}-2`

- [x] {Completed task}
  - Task ID: `phase-1-{sanitized-name}-3`

## Phase 2: {Phase Name}

- [ ] {Task description}
  - Task ID: `phase-2-{sanitized-name}-1`

---

## Progress Summary

- Total Tasks: {N}
- Completed: {M}
- Remaining: {N-M}
```

**Task ID Pattern:** `phase-{N}-{sanitized-name}-{M}`
- `N` = Phase number (1-indexed)
- `sanitized-name` = Lowercase, hyphens for spaces, no special chars
- `M` = Task counter within phase (1-indexed)

**Valid Examples:**
- `phase-1-setup-configuration-1`
- `phase-2-user-authentication-3`
- `phase-3-api-integration-2`

**Invalid Examples:**
- `phase1-setup-1` - Missing hyphen after "phase"
- `Phase-1-Setup-1` - Must be lowercase
- `phase-1-setup` - Missing task number

### Prompt Files (v5 Format)

Individual prompt files with frontmatter metadata.

**Location:** `.clavix/outputs/prompts/<id>.md`

**Format:**
```markdown
---
id: std-20250127-143022-a3f2
timestamp: 2025-01-27T14:30:22Z
executed: false
originalPrompt: "the user's original prompt text"
depthUsed: standard|comprehensive
---

# Improved Prompt

<optimized prompt content>

## Quality Scores
- **Clarity**: 85%
- **Efficiency**: 80%
- **Structure**: 90%
- **Completeness**: 75%
- **Actionability**: 88%
- **Overall**: 84% (good)

## Original Prompt
```
<user's original prompt>
```
```

**Agent Usage:**
- LIST prompts: `ls .clavix/outputs/prompts/*.md`
- READ prompt: Use Read tool on `.clavix/outputs/prompts/<id>.md`
- FIND latest: Sort files by timestamp in filename
- MARK executed: Edit frontmatter to set `executed: true`

### PRD Files

**Full PRD:** `.clavix/outputs/{project}/full-prd.md`
- Complete team-facing document
- All sections expanded

**Quick PRD:** `.clavix/outputs/{project}/quick-prd.md`
- 2-3 paragraph AI-optimized version
- Key requirements only

**Mini PRD:** `.clavix/outputs/{project}/mini-prd.md`
- From /clavix:summarize
- Extracted from conversation

### Directory Structure Overview (v5)

```
.clavix/
├── outputs/
│   ├── prompts/
│   │   └── *.md                    # Prompt files (metadata in frontmatter)
│   ├── {project-name}/
│   │   ├── full-prd.md
│   │   ├── quick-prd.md
│   │   ├── tasks.md
│   │   └── .clavix-implement-config.json
│   └── archive/
│       └── {archived-project}/
└── config.json                     # Global config
```
